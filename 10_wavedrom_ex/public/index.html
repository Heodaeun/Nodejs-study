<!DOCTYPE html>
<html>
    <head>
        <title>WaveDrom</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- wavedrom web usage -->
        <script src="http://wavedrom.com/skins/default.js" type="text/javascript"></script>
        <script src="http://wavedrom.com/wavedrom.min.js" type="text/javascript"></script>
    </head>
    <body onload="WaveDrom.ProcessAll()">
    <!--script type="WaveDrom"을 timing diagram으로 출력함-->
        <h1 id="head">WaveDrom</h1>
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <script src="http://code.jquery.com/jquery-1.11.1.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
        
        <p id="page"></p>   
        <button onclick="showName()">click</button>

        <script type="text/javascript" scr="wavedrom.js"></script>
        <!-- <script id=wavedrom type="WaveDrom">
            { signal : [
                { name :"a", wave :"1...."}
            ]}
        </script> -->

        <script id="ex"></script>


        <script>
            var s = {"signal":[{"name":"a","wave":"1.."}]}
            // var s = { signal : [
            //     { name: "clk", wave: "p......" },
            //     { name: "bus", wave: "x.34.5x", data: "head body tail" },
            //     { name: "wire", wave: "0.1..0." },
            // ]}

            // var ex = { signal : [
            //     { name: "a", wave: "1.."}
            // ]}

            var socket = io("http://localhost:4000"); //connect to server

            $(document).ready(function(){

            });

            socket.on('connect', function() {
                console.log('connected');
            });
            
            socket.on('send_WaveDrom', function(drom){
                console.log('wavedrom: ', drom);

                var ref = document.getElementsByTagName('script')[0],
                    script = document.createElement('script');
                script.setAttribute('type', "WaveDrom");
                script.setAttribute('id', 'problem');
                script.innerHTML = s;
                ref.parentNode.insertBefore(script, ref);

                // var scr = document.getElementById('problem');      
                // console.log('scr:', scr.toString());
                // console.log(scr.text);



                
                $('#page').text(drom.signal[0].wave);

                // var scr = document.getElementById('wavedrom');                
                // scr.type = "WaveDrom";
                // scr.innerText = drom;
                // console.log(scr.innerText);
                // $('#wavedrom').type("WaveDrom");
                // $('#wavedrom').text(drom);

                // var p = document.getElementById('p');
                // p.innerText = drom.signal[0].wave;

                // console.log('s :', s);
                // console.log("ex: ", ex);
                // s = drom;
                // ex = drom;
                // console.log('s :', s);
                // console.log("ex: ", ex);

                // var scr = document.getElementById('wavedrom');
                // console.log(scr);
                
                // ex.type = "WaveDrom";
                // scr.innerText = drom;


                $("#wavedrom").load(window.location.href + "#wavedrom");
                // var ex = document.getElementById('ex');
                // console.log('ex: ', ex);
                // console.log("s: ", scr.toString());
            });
        </script>
    </body>
    <style>
        h1, h4 {
            text-align: center;
            font-family: 'Lato', sans-serif;
        }
    </style>
</html>